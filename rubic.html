<html>

<script id="vertex-shader" type="x-shader/x-vertex">
	
	attribute vec4 v_Norm;
	attribute vec4 v_Pos;
	
	uniform vec4 v_Light;
	uniform vec4 v_Camera;
	
	uniform mat4 m_Model;
	uniform mat4 m_View;
	uniform mat4 m_Proj;
	
	varying vec3 o_Norm;
	varying vec3 o_Camera;
	varying vec3 o_Light;
	
	void main() 
	{
		mat4 m_ModelView = m_View * m_Model;
		vec4 tmp_Pos = m_ModelView * v_Pos;
	
		o_Norm = normalize(m_ModelView * v_Norm).xyz;
		o_Light = (m_View * v_Light).xyz;
		o_Camera = normalize(-tmp_Pos).xyz;
		
		// directional light
		if (v_Light.w != 0.0 )
			  o_Light = o_Light - tmp_Pos.xyz;
	
		gl_Position = m_Proj * tmp_Pos;
	}  
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
	
	precision mediump float;

	varying vec3 o_Norm;
	varying vec3 o_Camera;
	varying vec3 o_Light;
	
	uniform float col_Shininess;
	uniform vec3 col_Ambient, col_Diffuse, col_Specular;
	uniform vec3 light_Ambient, light_Diffuse, light_Specular;
	
	void main()
	{
		vec3 N = normalize(o_Norm);
		vec3 E = normalize(o_Camera);
		vec3 L = normalize(o_Light);
	
		vec3 H = normalize(L + E);   
		vec3 ambient = col_Ambient * light_Ambient;
	
		float Kd = max(dot(L, N), 0.0);
		vec3 diffuse = Kd * col_Diffuse * light_Diffuse;
		
		float Ks = pow(max(dot(N, H), 0.0), col_Shininess);
		vec3 specular = Ks * col_Specular * light_Specular;
	
		// discard the specular highlight if the light's behind the vertex
		if (dot(L, N) < 0.0) 
			specular = vec3(0.0, 0.0, 0.0);
		
		gl_FragColor.xyz = ambient + diffuse + specular;
		gl_FragColor.a = 1.0;
	}
</script>

<script type="text/javascript" src="Common/webgl-utils.js"></script>
<script type="text/javascript" src="Common/initShaders.js"></script>
<script type="text/javascript" src="Common/MV.js"></script>

<script type="text/javascript" src="3DObject.js"></script>
<script type="text/javascript" src="Camera.js"></script>
<script type="text/javascript" src="Light.js"></script>
<script type="text/javascript" src="Cube.js"></script>
<script type="text/javascript" src="main.js"></script>

<body>
<canvas id="gl-canvas" width="512"" height="512">
Oops ... your browser doesn't support the HTML5 canvas element
</canvas>
   
<br/>

</body>
</html>
